<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Webhook to Jira Integration System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 20px;
        }
        
        .architecture {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            margin: 2rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .architecture h2 {
            color: #667eea;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }
        
        .flow-diagram {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }
        
        .components {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .component {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            border: 2px solid #e1e4e8;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .component:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .component h3 {
            color: #24292e;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .component .icon {
            font-size: 1.5rem;
        }
        
        .component ul {
            list-style: none;
            padding: 0;
        }
        
        .component li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .component li:last-child {
            border-bottom: none;
        }
        
        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }
        
        .status-active {
            background: #28a745;
            color: white;
        }
        
        .status-pending {
            background: #ffc107;
            color: #333;
        }
        
        .status-process {
            background: #17a2b8;
            color: white;
        }
        
        .directories {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            margin: 2rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .directories h2 {
            color: #667eea;
            margin-bottom: 1.5rem;
        }
        
        .dir-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        .dir-item {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }
        
        .dir-item strong {
            color: #24292e;
            display: block;
            margin-bottom: 0.5rem;
        }
        
        .dir-item span {
            color: #586069;
            font-size: 0.9rem;
        }
        
        .commands {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            margin: 2rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .commands h2 {
            color: #667eea;
            margin-bottom: 1.5rem;
        }
        
        .command-group {
            margin: 1.5rem 0;
        }
        
        .command-group h3 {
            color: #24292e;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .code-block {
            background: #1b1f23;
            color: #e1e4e8;
            padding: 1rem;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin: 0.5rem 0;
        }
        
        .code-block.bash {
            background: #2d333b;
        }
        
        .comment {
            color: #8b949e;
        }
        
        .configuration {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            margin: 2rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .configuration h2 {
            color: #667eea;
            margin-bottom: 1.5rem;
        }
        
        .config-item {
            background: #f6f8fa;
            border: 1px solid #d1d5da;
            border-radius: 6px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .config-item h4 {
            color: #24292e;
            margin-bottom: 1rem;
        }
        
        .troubleshooting {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        
        .troubleshooting h2 {
            color: #856404;
            margin-bottom: 1rem;
        }
        
        .troubleshooting ul {
            margin-left: 1.5rem;
        }
        
        .troubleshooting li {
            margin: 0.5rem 0;
        }
        
        footer {
            background: #24292e;
            color: white;
            text-align: center;
            padding: 2rem 0;
            margin-top: 4rem;
        }
        
        .tag {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            background: #e1e4e8;
            color: #24292e;
            border-radius: 3px;
            font-size: 0.85rem;
            margin: 0.2rem;
        }
        
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
        
        .info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <header>
        <h1>GitHub Webhook â†’ Claude AI â†’ Jira Integration</h1>
        <p>ìë™í™”ëœ Git ì»¤ë°‹ ë¶„ì„ ë° Jira ì´ìŠˆ ì—…ë°ì´íŠ¸ ì‹œìŠ¤í…œ</p>
    </header>
    
    <div class="container">
        <section class="architecture">
            <h2>ğŸ“‹ ì‹œìŠ¤í…œ ê°œìš”</h2>
            <p>ì´ ì‹œìŠ¤í…œì€ GitHub Push ì´ë²¤íŠ¸ë¥¼ ë°›ì•„ Claude AIë¡œ ìë™ ë¶„ì„í•œ í›„, ë¶„ì„ ê²°ê³¼ë¥¼ Jira ì´ìŠˆì— ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ëŠ” 3ë‹¨ê³„ íŒŒì´í”„ë¼ì¸ì…ë‹ˆë‹¤.</p>
            
            <div class="flow-diagram">
                <pre>
[GitHub Push Event]
        â†“
[github.hook.php] â†’ ì›¹í›… ìˆ˜ì‹  â†’ pending_webhooks/
        â†“
[claude.analyze.php] â†’ AI ë¶„ì„ â†’ pending_analysis/
        â†“
[jira.hook.php] â†’ Jira ì—…ë°ì´íŠ¸ â†’ processed_jira/
                </pre>
            </div>
        </section>

        <section class="components">
            <div class="component">
                <h3><span class="icon">ğŸ“¥</span> Stage 1: Webhook ìˆ˜ì‹ </h3>
                <ul>
                    <li><strong>github.hook.php</strong></li>
                    <li>GitHub ì›¹í›… ì´ë²¤íŠ¸ ìˆ˜ì‹ </li>
                    <li>ì„œëª… ê²€ì¦ (HMAC-SHA256)</li>
                    <li>JSON ë°ì´í„°ë¥¼ pending_webhooks/ì— ì €ì¥</li>
                    <li><span class="status-badge status-active">ìë™ ì‹¤í–‰</span></li>
                </ul>
            </div>

            <div class="component">
                <h3><span class="icon">ğŸ¤–</span> Stage 2: Claude AI ë¶„ì„</h3>
                <ul>
                    <li><strong>claude.analyze.php</strong></li>
                    <li>pending_webhooks/ì—ì„œ íŒŒì¼ ì½ê¸°</li>
                    <li>Claude CLIë¡œ ì»¤ë°‹ ë¶„ì„</li>
                    <li>í•œêµ­ì–´ ë¶„ì„ ë¦¬í¬íŠ¸ ìƒì„±</li>
                    <li>pending_analysis/ì— ë§ˆí¬ë‹¤ìš´ ì €ì¥</li>
                    <li><span class="status-badge status-process">Cron: ë§¤ë¶„ ì‹¤í–‰</span></li>
                </ul>
            </div>

            <div class="component">
                <h3><span class="icon">ğŸ“</span> Stage 3: Jira ì—…ë°ì´íŠ¸</h3>
                <ul>
                    <li><strong>jira.hook.php</strong></li>
                    <li>pending_analysis/ì—ì„œ ë¶„ì„ íŒŒì¼ ì½ê¸°</li>
                    <li>ì»¤ë°‹/ë¸Œëœì¹˜ì—ì„œ Jira í‹°ì¼“ ID ì¶”ì¶œ</li>
                    <li>ë§ˆí¬ë‹¤ìš´ì„ Jira í˜•ì‹ìœ¼ë¡œ ë³€í™˜</li>
                    <li>Jira REST APIë¡œ ì´ìŠˆ ì—…ë°ì´íŠ¸</li>
                    <li><span class="status-badge status-process">Cron: 2ë¶„ë§ˆë‹¤ ì‹¤í–‰</span></li>
                </ul>
            </div>
        </section>

        <section class="directories">
            <h2>ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°</h2>
            <div class="dir-grid">
                <div class="dir-item">
                    <strong>pending_webhooks/</strong>
                    <span>GitHub ì›¹í›… JSON íŒŒì¼ ëŒ€ê¸°</span>
                </div>
                <div class="dir-item">
                    <strong>pending_analysis/</strong>
                    <span>AI ë¶„ì„ ì™„ë£Œ, Jira ì—…ë°ì´íŠ¸ ëŒ€ê¸°</span>
                </div>
                <div class="dir-item">
                    <strong>processed_webhooks/</strong>
                    <span>ë¶„ì„ ì™„ë£Œëœ ì›¹í›… íŒŒì¼</span>
                </div>
                <div class="dir-item">
                    <strong>processed_jira/</strong>
                    <span>Jira ì—…ë°ì´íŠ¸ ì™„ë£Œ íŒŒì¼</span>
                </div>
                <div class="dir-item">
                    <strong>logs/</strong>
                    <span>ì—ëŸ¬ ë° ì„±ê³µ ë¡œê·¸</span>
                </div>
                <div class="dir-item">
                    <strong>locks/</strong>
                    <span>ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€ ë½ íŒŒì¼</span>
                </div>
                <div class="dir-item">
                    <strong>source/</strong>
                    <span>Git ì €ì¥ì†Œ í´ë¡ </span>
                </div>
                <div class="dir-item">
                    <strong>logs/claude_prompts/</strong>
                    <span>Claude í”„ë¡¬í”„íŠ¸ ë¡œê·¸</span>
                </div>
            </div>
        </section>

        <section class="commands">
            <h2>âš™ï¸ ì£¼ìš” ëª…ë ¹ì–´</h2>
            
            <div class="command-group">
                <h3>ìˆ˜ë™ ì‹¤í–‰</h3>
                <div class="code-block bash">
<span class="comment"># ì›¹í›… ì²˜ë¦¬ ë° Claude ë¶„ì„</span>
php claude.analyze.php

<span class="comment"># Jira ì—…ë°ì´íŠ¸</span>
php jira.hook.php

<span class="comment"># Shell ëŒ€ì•ˆ (PHP curl ì—†ì„ ë•Œ)</span>
./jira_integration.sh

<span class="comment"># ì˜ëª» ë°°ì¹˜ëœ ë¶„ì„ íŒŒì¼ ì´ë™</span>
./move_analysis_files.sh
                </div>
            </div>

            <div class="command-group">
                <h3>í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´</h3>
                <div class="code-block bash">
<span class="comment"># Jira API ì—°ê²° í…ŒìŠ¤íŠ¸</span>
php test_jira_connection.php

<span class="comment"># í…ŒìŠ¤íŠ¸ ì›¹í›… ë°ì´í„° ìƒì„±</span>
php test_webhook.php

<span class="comment"># ë¶„ì„ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</span>
php test_analyze.php
                </div>
            </div>

            <div class="command-group">
                <h3>Crontab ì„¤ì • (ìë™í™” í•„ìˆ˜)</h3>
                <div class="code-block bash">
<span class="comment"># crontab -e ì— ì¶”ê°€:</span>
* * * * * cd /var/www/html/webhookTest && php claude.analyze.php >> logs/cron_analyze.log 2>&1
*/2 * * * * cd /var/www/html/webhookTest && php jira.hook.php >> logs/cron_jira.log 2>&1
* * * * * /var/www/html/webhookTest/move_analysis_files.sh >> logs/file_mover.log 2>&1
                </div>
            </div>

            <div class="command-group">
                <h3>Docker ìš´ì˜</h3>
                <div class="code-block bash">
<span class="comment"># Docker ì»¨í…Œì´ë„ˆ ë¹Œë“œ ë° ì‹¤í–‰</span>
cd docker/
docker-compose up -d

<span class="comment"># ì»¨í…Œì´ë„ˆ ì ‘ì†</span>
docker exec -it webhooktest_web_1 bash

<span class="comment"># ë¡œê·¸ í™•ì¸</span>
docker logs webhooktest_web_1
                </div>
            </div>
        </section>

        <section class="configuration">
            <h2>ğŸ”§ í™˜ê²½ ì„¤ì •</h2>
            
            <div class="config-item">
                <h4>.env íŒŒì¼ (í•„ìˆ˜)</h4>
                <div class="code-block">
JIRA_BASE_URL=https://your-domain.atlassian.net
JIRA_EMAIL=your-email@example.com
JIRA_API_TOKEN=your-api-token
WEBHOOK_SECRET=test123
                </div>
            </div>

            <div class="config-item">
                <h4>GitHub Webhook ì„¤ì •</h4>
                <ul>
                    <li><strong>Payload URL:</strong> https://your-domain.com/webhookTest/github.hook.php</li>
                    <li><strong>Content type:</strong> application/json</li>
                    <li><strong>Secret:</strong> .envì˜ WEBHOOK_SECRETì™€ ë™ì¼</li>
                    <li><strong>Events:</strong> Just the push event ì„ íƒ</li>
                </ul>
            </div>

            <div class="config-item">
                <h4>ë””ë ‰í† ë¦¬ ê¶Œí•œ</h4>
                <div class="code-block bash">
chmod 755 *.php *.sh
chmod 777 pending_* processed_* logs/
                </div>
            </div>
        </section>

        <section class="architecture">
            <h2>âœ¨ ì£¼ìš” ê¸°ëŠ¥</h2>
            
            <div class="info">
                <h4>Claude AI ë¶„ì„</h4>
                <ul>
                    <li>Git diff ê¸°ë°˜ ë³€ê²½ì‚¬í•­ ë¶„ì„</li>
                    <li>í•œêµ­ì–´ ìš”ì•½ ìƒì„± (ì£¼ìš” ë³€ê²½ì‚¬í•­, ì˜í–¥ ëª¨ë“ˆ, ë³€ê²½ ëª©ì )</li>
                    <li>ë³‘í•© ì¶©ëŒ ê°ì§€ ë° íŠ¹ë³„ ì²˜ë¦¬</li>
                    <li>ëŒ€ëŸ‰ ì»¤ë°‹ ì‹œ ìë™ ìš”ì•½ ëª¨ë“œ</li>
                </ul>
            </div>

            <div class="info">
                <h4>Jira í‹°ì¼“ ID ì¶”ì¶œ</h4>
                <ul>
                    <li>íŒ¨í„´: [P03-45], PROJ-123, ABC1-234</li>
                    <li>ì»¤ë°‹ ë©”ì‹œì§€ ìš°ì„  ê²€ìƒ‰</li>
                    <li>ë¸Œëœì¹˜ëª… í´ë°± ê²€ìƒ‰</li>
                </ul>
            </div>

            <div class="info">
                <h4>ë§ˆí¬ë‹¤ìš´ â†’ Jira ë³€í™˜</h4>
                <ul>
                    <li>í—¤ë”: # â†’ h1., ## â†’ h2.</li>
                    <li>êµµì€ ê¸€ì”¨: **text** â†’ *text*</li>
                    <li>ì½”ë“œ: `code` â†’ {{code}}</li>
                    <li>ì½”ë“œ ë¸”ë¡: ```code``` â†’ {code}code{code}</li>
                    <li>ì´ëª¨ì§€ ë³€í™˜ ì§€ì›</li>
                </ul>
            </div>
        </section>

        <section class="troubleshooting">
            <h2>ğŸ” ë¬¸ì œ í•´ê²°</h2>
            <ul>
                <li><strong>Lock íŒŒì¼ ì—ëŸ¬:</strong> locks/ ë””ë ‰í† ë¦¬ì˜ ì˜¤ë˜ëœ ë½ íŒŒì¼ ì‚­ì œ</li>
                <li><strong>Jira 401/403:</strong> API í† í° ë° ê¶Œí•œ í™•ì¸</li>
                <li><strong>ë¶„ì„ íŒŒì¼ì´ ë£¨íŠ¸ì— ìƒì„±:</strong> move_analysis_files.sh ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰</li>
                <li><strong>Claude ë¶„ì„ ì‹¤íŒ¨:</strong> Claude CLI ì„¤ì¹˜ í™•ì¸ (which claude)</li>
                <li><strong>ì›¹í›… ë¯¸ìˆ˜ì‹ :</strong> GitHub webhook secretì´ .envì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸</li>
            </ul>
            
            <div class="warning">
                <strong>âš ï¸ ì£¼ì˜ì‚¬í•­:</strong>
                <ul>
                    <li>PHP 8.2+ ë° curl extension í•„ìš”</li>
                    <li>Claude CLI ì„¤ì¹˜ í•„ìˆ˜</li>
                    <li>Crontab ì„¤ì • ì—†ìœ¼ë©´ ìë™í™” ì•ˆë¨</li>
                    <li>analysis_*.md íŒŒì¼ì´ ë£¨íŠ¸ì— ìƒì„±ë˜ë©´ move_analysis_files.sh ì‹¤í–‰</li>
                </ul>
            </div>
        </section>

        <section class="architecture">
            <h2>ğŸ“Š ë¡œê·¸ íŒŒì¼</h2>
            <div class="dir-grid">
                <div class="dir-item">
                    <strong>webhook_errors.log</strong>
                    <span>GitHub ì›¹í›… ìˆ˜ì‹  ì˜¤ë¥˜</span>
                </div>
                <div class="dir-item">
                    <strong>analysis_errors.log</strong>
                    <span>Claude ë¶„ì„ ì˜¤ë¥˜</span>
                </div>
                <div class="dir-item">
                    <strong>jira_hook_errors.log</strong>
                    <span>Jira API ì˜¤ë¥˜</span>
                </div>
                <div class="dir-item">
                    <strong>jira_success.log</strong>
                    <span>Jira ì—…ë°ì´íŠ¸ ì„±ê³µ ê¸°ë¡</span>
                </div>
                <div class="dir-item">
                    <strong>cron_analyze.log</strong>
                    <span>ë¶„ì„ Cron ì‹¤í–‰ ë¡œê·¸</span>
                </div>
                <div class="dir-item">
                    <strong>cron_jira.log</strong>
                    <span>Jira Cron ì‹¤í–‰ ë¡œê·¸</span>
                </div>
            </div>
        </section>
    </div>
    
    <footer>
        <p>GitHub Webhook to Jira Integration System v1.0</p>
        <p>Powered by Claude AI | PHP 8.2+ | Docker</p>
    </footer>
</body>
</html>